{"version":3,"file":"marionette-dropdown","sources":["marionette-dropdown/src/cocktail.js","marionette-dropdown/src/views/item.js","marionette-dropdown/src/mixins/dropdown.js","marionette-dropdown/src/templates.js","marionette-dropdown/src/loading.js","marionette-dropdown/src/utils.js","marionette-dropdown/src/views/dropdown.js","marionette-dropdown/src/index.js"],"sourcesContent":["\nimport _ from 'lodash'\n\nimport Backbone from 'backbone'\nimport Marionette from 'marionette'\nimport Cocktail from 'cocktail'\n\nvar originalExtend = Backbone.Model.extend\n\nvar extend = function (protoProps, classProps) {\n  var klass = originalExtend.call(this, protoProps, classProps)\n  var mixins = klass.prototype.mixins\n  if (mixins && klass.prototype.hasOwnProperty('mixins')) {\n    Cocktail.mixin(klass, mixins)\n  }\n  return klass\n}\n\n_.each([\n  Backbone.Model,\n  Backbone.Collection,\n  Backbone.Router,\n  Backbone.View,\n  Marionette.ItemView,\n  Marionette.CollectionView,\n  Marionette.CompositeView,\n  Marionette.LayoutView\n], function (klass) {\n  klass.mixin = function mixin () {\n    Cocktail.mixin(this, _.toArray(arguments))\n  }\n  klass.extend = extend\n})\n","\nimport Marionette from 'marionette'\n\nexport default Marionette.ItemView.extend({\n  tagName: 'li',\n  template: (data) => data.text,\n  events: {\n    mouseover: 'onMouseOver'\n  },\n  triggers: {\n    click: 'select'\n  },\n  onMouseOver: function () {\n    this.trigger('focus')\n  },\n  attributes: function () {\n    return {'data-value': this.model.id}\n  }\n})\n","\nimport $ from 'jquery'\nimport _ from 'lodash'\n\nimport animation from 'animation'\n\nexport default {\n  events: {\n    keydown: 'onKeyDown'\n  },\n  initialize: function (options) {\n    this.maxSize = options.maxSize\n    this.expanded = false\n    this.showing = false\n    this.hiding = false\n    this.name = options.name\n    this.parent = options.parent\n    if (this.getCollection) {\n      this.collection = this.getCollection()\n    } else {\n      this.collection = options.collection\n    }\n  },\n  onRender: function () {\n    if (this.expanded) { this.list.$el.css({opacity: 1}) }\n  },\n  onBeforeShow: function () {\n    this.scrollParent = this.$el.closest('.nano-content')\n  },\n  onParentScroll: function (e) {\n    this.positionList()\n  },\n  onDestroy: function () {\n    $(window).off('click', this.hideListFunc)\n    this.scrollParent.off('scroll', this.hideListFunc)\n    this.scrollParent.off('scroll', this.onParentScrollFunc)\n  },\n  onKeyDown: function (e) {\n    if (this.list && this.list.onKeyDown) this.list.onKeyDown(e)\n  },\n  serializeData: function () {\n    return {name: this.name}\n  },\n  toggleList: function () {\n    if (this.expanded) {\n      this.hideList()\n    } else {\n      this.showList()\n    }\n  },\n  resetListWidth: function (width) {\n    if (this.list && this.list.$el) {\n      var listWidth = this.getListWidth()\n      var elWidth = this.$el.outerWidth()\n      this.list.$el.outerWidth(_.max([listWidth, elWidth]))\n    }\n  },\n  positionList: function () {\n    var listEl = this.list.$el\n    var windowHeight = $(window).height()\n    var elOffset = this.$el.offset()\n    var elHeight = this.$el.outerHeight()\n    if (this.isExpandedToTop) {\n      listEl.css({top: '', bottom: (windowHeight - elOffset.top)})\n    } else {\n      listEl.css({top: (elOffset.top + elHeight), bottom: ''})\n    }\n    listEl.css('left', elOffset.left)\n  },\n  showList: function () {\n    if (!this.showing && !this.hiding && !this.collection.isEmpty()) {\n      // Add the class indicating open status\n      this.$el.addClass('open')\n      // Create the list view\n      this.list = new this.focusListView({\n        maxSize: this.maxSize,\n        childView: this.dropdownItemView,\n        collection: this.collection\n      })\n      // Flatten the list element\n      animation.flat(this.list.$el)\n      // Prevent list from automatically rendering on collection reset\n      this.list.stopListening(this.collection, 'reset')\n      // Render the list before showing\n      this.list.render()\n      // Apply parent styles\n      this.list.$el.css(this.$el.css(['font-size', 'line-height']))\n      // Reset the list width\n      this.resetListWidth()\n      // Move the list element to the indicated overlay\n      this.getOverlay().append(this.list.$el)\n      // Get the list element\n      var listEl = this.list.$el\n      // Reset the list height\n      this.list.resetHeight()\n      var listHeight = listEl.height()\n      // Decide which way to expand the list\n      var elOffset = this.$el.offset()\n      var windowHeight = $(window).height()\n      var elHeight = this.$el.outerHeight()\n      var potentialTop = elOffset.top - listHeight\n      var potentialBottom = elOffset.top + elHeight + listHeight\n      this.isExpandedToTop = (potentialBottom > windowHeight) && (potentialTop > 0)\n      // Position the list before animation\n      this.positionList()\n      // Trigger the dropdown show event\n      this.trigger('dropdown:show')\n      // Attach to event for hiding and scrolling the list on scroll\n      this.onParentScrollFunc = this.onParentScroll.bind(this)\n      this.scrollParent.on('scroll', this.onParentScrollFunc)\n      // Attach to event for hiding the list on click (skip current)\n      _.defer(() => {\n        this.hideListFunc = _.bind(this.hideList, this, null)\n        $(window).one('click', this.hideListFunc)\n        this.scrollParent.one('scroll', this.hideListFunc)\n      })\n      // Expand and show the list\n      this.showing = true\n      return animation.grow(listEl, 'height', listHeight).then(() => {\n        this.showing = false\n        this.expanded = true\n        this.list.refreshScroll()\n        // Listen to select events\n        this.listenTo(this.list, 'select', this.onItemSelect)\n        // Trigger freeze on parent if available\n        if (this.parent) { this.parent.trigger('freeze') }\n      })\n    } else {\n      return Promise.resolve()\n    }\n  },\n  hideList: function () {\n    if ((!this.hiding && this.expanded) || this.showing) {\n      // Remove the class indicating open status\n      this.$el.removeClass('open')\n      // Remove the item select handler after potential handling\n      _.defer(() => this.stopListening(this.list, 'select', this.onItemSelect))\n      // Shrink and hide the element\n      this.hiding = true\n      return animation.shrink(this.list.$el, 'height').then(() => {\n        this.hiding = false\n        this.expanded = false\n        // Destory the list\n        this.list.destroy()\n        // Detach from the scroll and hiding events\n        $(window).off('click', this.hideListFunc)\n        this.scrollParent.off('scroll', this.onParentScrollFunc)\n        this.scrollParent.off('scroll', this.hideListFunc)\n        // Trigger the hidden event\n        this.trigger('hidden')\n        // Trigger freeze on parent if available\n        if (this.parent) { this.parent.trigger('thaw') }\n      })\n    } else {\n      return Promise.resolve()\n    }\n  }\n}\n","import handlebars from 'handlebars'\n\nexport default {\n'dropdown': handlebars.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper;\n\n  return \" name=\\\"\"\n    + container.escapeExpression(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : {},{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\"\";\n},\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1;\n\n  return \"<div class=\\\"dropdown-button\\\">\\n  <div class=\\\"button-text\\\"></div>\\n  <i class=\\\"icon-expand\\\" />\\n</div>\\n<input type=\\\"hidden\\\"\"\n    + ((stack1 = helpers[\"if\"].call(depth0 != null ? depth0 : {},(depth0 != null ? depth0.name : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \" />\\n\";\n},\"useData\":true}),\n'spinner': handlebars.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<svg class=\\\"spinner\\\" width=\\\"65px\\\" height=\\\"65px\\\" viewBox=\\\"0 0 66 66\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n  <circle class=\\\"spinner-path\\\" fill=\\\"none\\\" stroke-width=\\\"6\\\" stroke-linecap=\\\"round\\\" cx=\\\"33\\\" cy=\\\"33\\\" r=\\\"30\\\"></circle>\\n</svg>\\n\";\n},\"useData\":true}),\n}\n","\nimport $ from 'jquery'\n\nimport templates from './templates'\n\nconst spinnerHtml = templates['spinner']({})\n\nfunction add (el) {\n  var loadingEl = $('<div class=\"loading\"></div>')\n  loadingEl.append(spinnerHtml)\n  el.append(loadingEl)\n}\n\nfunction remove (el) {\n  el.children('.loading').remove()\n}\n\nfunction loading (el, on) {\n  if (on) {\n    add(el)\n  } else {\n    remove(el)\n  }\n}\n\nexport default loading\n","\nimport _ from 'lodash'\n\nimport loading from './loading'\n\nfunction defined () {\n  return _.find(arguments, function (o) {\n    return (o !== undefined)\n  })\n}\n\nfunction transfer (sender, receiver, eventName) {\n  sender.listenTo(sender, eventName, function () {\n    var args = _([eventName]).concat(arguments).value()\n    receiver.trigger.apply(receiver, args)\n  })\n}\n\nfunction loadingEvents (receiver, sender) {\n  transfer(sender, receiver, 'loading')\n  transfer(sender, receiver, 'loaded')\n}\n\nfunction loadingActions (view) {\n  view.listenTo(view, 'loading', () => { loading(view.$el, true) })\n  view.listenTo(view, 'loaded', () => { loading(view.$el, false) })\n}\n\nexport default {\n  defined,\n  loadingActions,\n  loadingEvents\n}\n","\nimport $ from 'jquery'\nimport _ from 'lodash'\n\nimport Marionette from 'marionette'\nimport {FocusListView} from 'focuslist'\n\nimport ItemView from './item'\nimport DropdownMixin from '../mixins/dropdown'\n\nimport utils from '../utils'\nimport templates from '../templates'\n\nconst DropdownFocusListView = FocusListView.extend({\n  attributes: {class: 'dropdownList focusList'}\n})\n\nexport default Marionette.LayoutView.extend({\n  mixins: [DropdownMixin],\n  template: templates['dropdown'],\n  focusListView: DropdownFocusListView,\n  dropdownItemView: ItemView,\n  attributes: {\n    class: 'dropdown'\n  },\n  ui: {\n    button: '.dropdown-button',\n    text: '.button-text',\n    input: 'input'\n  },\n  events: {\n    'change @ui.input': 'onInputChange',\n    'click @ui.button': 'onButtonClick'\n  },\n  initialize: function (options) {\n    this.listenTo(this, 'dropdown:show', this.onDropdownShow)\n    utils.loadingEvents(this, this.collection)\n    utils.loadingActions(this, true)\n  },\n  onDropdownShow: function () {\n    // Indicate currently selected item with focus\n    if (this.selected) {\n      var child = this.list.children.findByModel(this.selected)\n      if (child) { child.$el.addClass('focus') }\n    }\n  },\n  onRender: function () {\n    this.determineState()\n    this.listenTo(this.collection, 'reset', this.determineState)\n  },\n  onShow: function () {\n    if (this.selected) { this.select(this.selected, true) }\n  },\n  onInputChange: function () {\n    var value = this.ui.input.val()\n    this.selectId(value)\n  },\n  onButtonClick: function (e) {\n    if (!this.expanded) {\n      _.defer(this.showList.bind(this))\n    }\n  },\n  onItemSelect: function (child) {\n    this.select(child.model, true)\n    this.hideList()\n  },\n  getOverlay: function () {\n    return $('body')\n  },\n  getFirst: function () {\n    var visible = this.collection.filter(function (o) {\n      return !(o.get('visible') === false)\n    })\n    return _.first(visible)\n  },\n  getSelected: function () {\n    return this.selected\n  },\n  getListWidth: function () {\n    var el = this.ui.text\n    var text = el.text()\n    var width = 0\n    el.css({visibility: 'hidden'})\n    this.collection.each((model) => {\n      el.text(model.get('text'))\n      if (el.width() > width) width = el.width()\n    })\n    el.html(text)\n    el.css('visibility', '')\n    return width\n  },\n  determineState: function () {\n    this.disabled = (this.collection.size() === 0)\n    if (this.disabled) {\n      this.$el.addClass('disabled')\n      this.select(null)\n    } else {\n      this.$el.removeClass('disabled')\n      var id = this.ui.input.val() || (this.selected && this.selected.id)\n      this.select(this.collection.get(id) || this.getFirst())\n    }\n  },\n  select: function (model, trigger) {\n    var changed = !(this.selected === model)\n    this.selected = model\n    if (this.isRendered) {\n      if (this.selected) {\n        this.ui.text.html(this.selected.get('text'))\n        this.ui.input.val(this.selected.id)\n      } else {\n        this.ui.text.html('---')\n        this.ui.input.val('')\n      }\n      if (trigger) { this.ui.input.trigger('change') }\n    }\n    if (changed) { this.trigger('select', this.selected) }\n  },\n  selectId: function (id, trigger) {\n    if (id === undefined || id === null || _.size(id) === 0) {\n      this.select(this.getFirst(), trigger)\n    } else {\n      this.select(this.collection.get(id), trigger)\n    }\n  },\n  refresh: function () {\n    this.ui.text.css('min-width', this.getListWidth())\n  },\n  setVisibleOptions: function (visible) {\n    // Set the visibility of each model in the collection\n    this.collection.each(function (model) {\n      model.set('visible', _.includes(visible, model.id))\n    })\n    // Determine if the selection should be changed\n    if (this.selected) {\n      if (this.selected.get('visible') === false) {\n        this.select(this.getFirst())\n      }\n    }\n    // Re-render the list and refresh calculations\n    this.refresh()\n  }\n})\n","\nimport './cocktail'\n\nimport DropdownView from './views/dropdown'\nimport DropdownItemView from './views/item'\nimport DropdownMixin from './mixins/dropdown'\n\nexport default {\n  DropdownView,\n  DropdownItemView,\n  DropdownMixin\n}\n"],"names":["FocusListView"],"mappings":"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"}