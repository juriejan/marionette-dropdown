{"version":3,"file":"marionette-dropdown","sources":["marionette-dropdown/src/cocktail.js","marionette-dropdown/src/views/item.js","marionette-dropdown/src/mixins/dropdown.js","marionette-dropdown/src/utils.js","marionette-dropdown/src/templates.js","marionette-dropdown/src/views/dropdown.js","marionette-dropdown/src/index.js"],"sourcesContent":["\nimport _ from 'lodash'\n\nimport Backbone from 'backbone'\nimport Marionette from 'marionette'\nimport Cocktail from 'cocktail'\n\nvar originalExtend = Backbone.Model.extend\n\nvar extend = function (protoProps, classProps) {\n  var klass = originalExtend.call(this, protoProps, classProps)\n  var mixins = klass.prototype.mixins\n  if (mixins && klass.prototype.hasOwnProperty('mixins')) {\n    Cocktail.mixin(klass, mixins)\n  }\n  return klass\n}\n\n_.each([\n  Backbone.Model,\n  Backbone.Collection,\n  Backbone.Router,\n  Backbone.View,\n  Marionette.ItemView,\n  Marionette.CollectionView,\n  Marionette.CompositeView,\n  Marionette.LayoutView\n], function (klass) {\n  klass.mixin = function mixin () {\n    Cocktail.mixin(this, _.toArray(arguments))\n  }\n  klass.extend = extend\n})\n","\nimport Marionette from 'marionette'\n\nexport default Marionette.ItemView.extend({\n  tagName: 'li',\n  template: (data) => data.text,\n  events: {\n    mouseover: 'onMouseOver'\n  },\n  triggers: {\n    click: 'select'\n  },\n  onMouseOver: function () {\n    this.trigger('focus')\n  },\n  attributes: function () {\n    return {'data-value': this.model.id}\n  }\n})\n","\nimport $ from 'jquery'\nimport _ from 'lodash'\n\nimport animation from 'animation'\n\nexport default {\n  events: {\n    keydown: 'onKeyDown'\n  },\n  initialize: function (options) {\n    this.maxSize = options.maxSize\n    this.expanded = false\n    this.showing = false\n    this.hiding = false\n    this.name = options.name\n    this.parent = options.parent\n    if (this.getCollection) {\n      this.collection = this.getCollection()\n    } else {\n      this.collection = options.collection\n    }\n  },\n  onRender: function () {\n    if (this.expanded) { this.list.$el.css({opacity: 1}) }\n  },\n  onBeforeShow: function () {\n    this.scrollParent = this.$el.closest('.nano-content')\n  },\n  onParentScroll: function (e) {\n    this.positionList()\n  },\n  onDestroy: function () {\n    $(window).off('click', this.hideListFunc)\n    this.scrollParent.off('scroll', this.hideListFunc)\n    this.scrollParent.off('scroll', this.onParentScrollFunc)\n  },\n  onKeyDown: function (e) {\n    if (this.list && this.list.onKeyDown) this.list.onKeyDown(e)\n  },\n  serializeData: function () {\n    return {name: this.name}\n  },\n  toggleList: function () {\n    if (this.expanded) {\n      this.hideList()\n    } else {\n      this.showList()\n    }\n  },\n  resetListWidth: function (width) {\n    if (this.list && this.list.$el) {\n      var listWidth = this.getListWidth()\n      var elWidth = this.$el.outerWidth()\n      this.list.$el.outerWidth(_.max([listWidth, elWidth]))\n    }\n  },\n  positionList: function () {\n    var listEl = this.list.$el\n    var windowHeight = $(window).height()\n    var elOffset = this.$el.offset()\n    var elHeight = this.$el.outerHeight()\n    if (this.isExpandedToTop) {\n      listEl.css({top: '', bottom: (windowHeight - elOffset.top)})\n    } else {\n      listEl.css({top: (elOffset.top + elHeight), bottom: ''})\n    }\n    listEl.css('left', elOffset.left)\n  },\n  showList: function () {\n    if (!this.showing && !this.hiding && !this.collection.isEmpty()) {\n      // Create the lost view\n      this.list = new this.focusListView({\n        maxSize: this.maxSize,\n        childView: this.dropdownItemView,\n        collection: this.collection\n      })\n      // Flatten the list element\n      animation.flat(this.list.$el)\n      // Prevent list from automatically rendering on collection reset\n      this.list.stopListening(this.collection, 'reset')\n      // Render the list before showing\n      this.list.render()\n      // Apply parent styles\n      this.list.$el.css(this.$el.css(['font-size', 'line-height']))\n      // Reset the list width\n      this.resetListWidth()\n      // Move the list element to the indicated overlay\n      this.getOverlay().append(this.list.$el)\n      // Get the list element\n      var listEl = this.list.$el\n      // Reset the list height\n      this.list.resetHeight()\n      var listHeight = listEl.height()\n      // Decide which way to expand the list\n      var elOffset = this.$el.offset()\n      var windowHeight = $(window).height()\n      var elHeight = this.$el.outerHeight()\n      var potentialTop = elOffset.top - listHeight\n      var potentialBottom = elOffset.top + elHeight + listHeight\n      this.isExpandedToTop = (potentialBottom > windowHeight) && (potentialTop > 0)\n      // Position the list before animation\n      this.positionList()\n      // Trigger the dropdown show event\n      this.trigger('dropdown:show')\n      // Attach to event for hiding and scrolling the list on scroll\n      this.onParentScrollFunc = this.onParentScroll.bind(this)\n      this.scrollParent.on('scroll', this.onParentScrollFunc)\n      // Attach to event for hiding the list on click (skip current)\n      _.defer(() => {\n        this.hideListFunc = _.bind(this.hideList, this, null)\n        $(window).one('click', this.hideListFunc)\n        this.scrollParent.one('scroll', this.hideListFunc)\n      })\n      // Expand and show the list\n      this.showing = true\n      return animation.grow(listEl, 'height', listHeight).then(() => {\n        this.showing = false\n        this.expanded = true\n        this.list.refreshScroll()\n        // Listen to select events\n        this.listenTo(this.list, 'select', this.onItemSelect)\n        // Trigger freeze on parent if available\n        if (this.parent) { this.parent.trigger('freeze') }\n      })\n    } else {\n      return Promise.resolve()\n    }\n  },\n  hideList: function () {\n    if ((!this.hiding && this.expanded) || this.showing) {\n      // Remove the item select handler after potential handling\n      _.defer(() => this.stopListening(this.list, 'select', this.onItemSelect))\n      // Shrink and hide the element\n      this.hiding = true\n      return animation.shrink(this.list.$el, 'height').then(() => {\n        this.hiding = false\n        this.expanded = false\n        // Destory the list\n        this.list.destroy()\n        // Detach from the scroll and hiding events\n        $(window).off('click', this.hideListFunc)\n        this.scrollParent.off('scroll', this.onParentScrollFunc)\n        this.scrollParent.off('scroll', this.hideListFunc)\n        // Trigger the hidden event\n        this.trigger('hidden')\n        // Trigger freeze on parent if available\n        if (this.parent) { this.parent.trigger('thaw') }\n      })\n    } else {\n      return Promise.resolve()\n    }\n  }\n}\n","\nimport _ from 'lodash'\n\nfunction defined () {\n  return _.find(arguments, function (o) {\n    return (o !== undefined)\n  })\n}\n\nfunction transfer (sender, receiver, eventName) {\n  sender.listenTo(sender, eventName, function () {\n    var args = _([eventName]).concat(arguments).value()\n    receiver.trigger.apply(receiver, args)\n  })\n}\n\nfunction loadingEvents (receiver, sender) {\n  transfer(sender, receiver, 'loading')\n  transfer(sender, receiver, 'loaded')\n}\n\nfunction loadingActions (view, inside) {\n  view.listenTo(view, 'loading', function () {\n    view.$el.loading(true, inside)\n  })\n  view.listenTo(view, 'loaded', function () {\n    view.$el.loading(false, inside)\n  })\n};\n\nexport default {\n  defined,\n  loadingActions,\n  loadingEvents\n}\n","import handlebars from 'handlebars'\n\nexport default {\n'dropdown': handlebars.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper;\n\n  return \" name=\\\"\"\n    + container.escapeExpression(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : {},{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\"\";\n},\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1;\n\n  return \"<div class=\\\"dropdown-button\\\">\\n  <div class=\\\"button-text\\\"></div>\\n  <i class=\\\"icon-expand\\\" />\\n</div>\\n<input type=\\\"hidden\\\"\"\n    + ((stack1 = helpers[\"if\"].call(depth0 != null ? depth0 : {},(depth0 != null ? depth0.name : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \" />\\n\";\n},\"useData\":true}),\n}\n","\nimport $ from 'jquery'\nimport _ from 'lodash'\n\nimport Marionette from 'marionette'\nimport {FocusListView} from 'focuslist'\n\nimport ItemView from './item'\nimport DropdownMixin from '../mixins/dropdown'\n\nimport utils from '../utils'\nimport templates from '../templates'\n\nconst DropdownFocusListView = FocusListView.extend({\n  attributes: {class: 'dropdownList focusList'}\n})\n\nexport default Marionette.LayoutView.extend({\n  mixins: [DropdownMixin],\n  template: templates['dropdown'],\n  focusListView: DropdownFocusListView,\n  dropdownItemView: ItemView,\n  attributes: {\n    class: 'dropdown'\n  },\n  ui: {\n    button: '.dropdown-button',\n    text: '.button-text',\n    input: 'input'\n  },\n  events: {\n    'change @ui.input': 'onInputChange',\n    'click @ui.button': 'onButtonClick'\n  },\n  initialize: function (options) {\n    this.listenTo(this, 'dropdown:show', this.onDropdownShow)\n    utils.loadingEvents(this, this.collection)\n    utils.loadingActions(this, true)\n  },\n  onDropdownShow: function () {\n    // Indicate currently selected item with focus\n    if (this.selected) {\n      var child = this.list.children.findByModel(this.selected)\n      if (child) { child.$el.addClass('focus') }\n    }\n  },\n  onRender: function () {\n    this.determineState()\n    this.listenTo(this.collection, 'reset', this.determineState)\n  },\n  onShow: function () {\n    if (this.selected) { this.select(this.selected, true) }\n  },\n  onInputChange: function () {\n    var value = this.ui.input.val()\n    this.selectId(value)\n  },\n  onButtonClick: function (e) {\n    if (!this.expanded) {\n      _.defer(this.showList.bind(this))\n    }\n  },\n  onItemSelect: function (child) {\n    this.select(child.model, true)\n    this.hideList()\n  },\n  getOverlay: function () {\n    return $('body')\n  },\n  getFirst: function () {\n    var visible = this.collection.filter(function (o) {\n      return !(o.get('visible') === false)\n    })\n    return _.first(visible)\n  },\n  getSelected: function () {\n    return this.selected\n  },\n  getListWidth: function () {\n    var el = this.ui.text\n    var text = el.text()\n    var width = 0\n    el.css({visibility: 'hidden'})\n    this.collection.each((model) => {\n      el.text(model.get('text'))\n      if (el.width() > width) width = el.width()\n    })\n    el.html(text)\n    el.css('visibility', '')\n    return width\n  },\n  determineState: function () {\n    this.disabled = (this.collection.size() === 0)\n    if (this.disabled) {\n      this.$el.addClass('disabled')\n      this.select(null)\n    } else {\n      this.$el.removeClass('disabled')\n      var id = this.ui.input.val() || (this.selected && this.selected.id)\n      this.select(this.collection.get(id) || this.getFirst())\n    }\n  },\n  select: function (model, trigger) {\n    var changed = !(this.selected === model)\n    this.selected = model\n    if (this.isRendered) {\n      if (this.selected) {\n        this.ui.text.html(this.selected.get('text'))\n        this.ui.input.val(this.selected.id)\n      } else {\n        this.ui.text.html('---')\n        this.ui.input.val('')\n      }\n      if (trigger) { this.ui.input.trigger('change') }\n    }\n    if (changed) { this.trigger('select', this.selected) }\n  },\n  selectId: function (id, trigger) {\n    if (id === undefined || id === null || _.size(id) === 0) {\n      this.select(this.getFirst(), trigger)\n    } else {\n      this.select(this.collection.get(id), trigger)\n    }\n  },\n  refresh: function () {\n    this.ui.text.css('min-width', this.getListWidth())\n  },\n  setVisibleOptions: function (visible) {\n    // Set the visibility of each model in the collection\n    this.collection.each(function (model) {\n      model.set('visible', _.includes(visible, model.id))\n    })\n    // Determine if the selection should be changed\n    if (this.selected) {\n      if (this.selected.get('visible') === false) {\n        this.select(this.getFirst())\n      }\n    }\n    // Re-render the list and refresh calculations\n    this.refresh()\n  }\n})\n","\nimport './cocktail'\n\nimport DropdownView from './views/dropdown'\nimport DropdownMixin from './mixins/dropdown'\n\nexport default {\n  DropdownView,\n  DropdownMixin\n}\n"],"names":["FocusListView"],"mappings":"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"}